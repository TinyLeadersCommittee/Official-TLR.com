---
// src/pages/community/paper-play.astro
import BaseLayout from '../../layouts/BaseLayout.astro';
import { lpoDetails } from '../../data/local-play-organizers/lpo-details';
import { communityStores } from '../../data/local-play-organizers/community-stores';

// Define types
interface Venue {
  place: string;
  location: string;
  frequency: string;
  website: string;
}

interface LPO {
  role: string;
  name: string;
  discordUsername: string;
  location: string;
  details: string;
  places: Venue[];
}
---

<BaseLayout title="Paper Play Directory">
  <main class="paper-play-page">

    <header class="page-intro">
      <h1>Paper Play Directory</h1>
      <p class="intro-text">
        Tiny Leaders: Reborn is community-powered. The events listed below are 
        coordinated by our dedicated <strong>Local Play Organizers (LPOs)</strong>.
      </p>
      
      <div class="disclaimer-box">
        <p>
          <strong>Note:</strong> Venues are listed for visibility to help you 
          find games. Inclusion does not imply an official partnership or 
          endorsement of the business by The Committee.
        </p>
      </div>
    </header>

    <hr />

    <section class="organizers-grid" aria-label="List of Local Play Organizers">
      
      {lpoDetails.map((lpo: LPO) => (
        <article class="organizer-card">
          
          <header class="org-header">
            <div class="org-identity">
              <h2>{lpo.name || "Community Leader"}</h2>
              
              <span class="region-text">{lpo.location}</span>

              {lpo.discordUsername && (
                <div class="discord-meta-line">
                  <span class="discord-label">Official TLR Discord:</span>
                  <span class="discord-tag">{lpo.discordUsername}</span>
                </div>
              )}

            </div>
            <span class="role-badge">{lpo.role}</span>
          </header>

          <section class="org-bio">
            <p>{lpo.details || "Contact on Discord for play details."}</p>
          </section>

          {lpo.places && lpo.places.length > 0 && (
            <section class="org-venues">
              <h3>Places to Play</h3>
              <div class="venues-list">
                {lpo.places.map((venue: Venue) => (
                  <article class="venue-item">
                    <div class="venue-info">
                      {venue.website ? (
                        <a href={venue.website} target="_blank" rel="nofollow noreferrer" class="venue-name">
                          {venue.place}
                        </a>
                      ) : (
                        <span class="venue-name">{venue.place}</span>
                      )}
                      
                      <span class="venue-meta">
                        {venue.location && <span>{venue.location} &bull; </span>}
                        {venue.frequency}
                      </span>
                    </div>
                    
                    {venue.website && (
                        <div class="venue-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                            <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/>
                        </svg>
                        </div>
                    )}
                  </article>
                ))}
              </div>
            </section>
          )}

        </article>
      ))}

    </section>

    <section class="cta-section">
      <h3>Do you run events in your area?</h3>
      <p>
        We are always looking for new LPOs to help grow the format. 
        Join the Discord and reach out to The Committee to learn about
        the requirements to join the Committee as an LPO.
      </p>
      <a href="https://discord.com/invite/jq9KWHAdTm" class="btn-primary">Join the Discord</a>
    </section>

    <section class="paper-play-container" aria-label="Community Reported Paper Play">
      <header class="section-header">
        <h2>Other Paper Play Opportunities</h2>
        <p class="disclaimer">Listings are community-reported and provided for 
          informational purposes only. Inclusion does not imply partnership or 
          endorsement.</p>
        <p>
          In addition to regularly organized events by Committtee Members, 
          Tiny Leaders: Reborn is played in paper across the world through 
          community-led initiatives. These listings are reported by players 
          and organizers and are provided for visibility only.
        </p>
      </header>

      {communityStores.length > 0 && (
        <div class="community-stores-grid">
          {communityStores.map((store) => (
            <article class="community-store-card">
              <div class="store-info">
                {store.website ? (
                  <a href={store.website} target="_blank" rel="nofollow noreferrer" class="store-name">
                    {store.name}
                  </a>
                ) : (
                  <span class="store-name">{store.name}</span>
                )}
                <span class="store-location">{store.location}</span>
              </div>
              
              <span class="store-frequency">{store.frequency}</span>
            </article>
          ))}
        </div>
      )}

      <div class="empty-state-message">
        <h3>Know of a store or playgroup hosting Tiny Leaders: Reborn?</h3>
        <p>Let us know so we can help players find games in their area.</p>
        <a href="mailto:committee@tinyleadersreborn.com" class="button button-outline">Submit a Location</a>
      </div>
    </section>

  </main>
</BaseLayout>

<style>
  /* --- LAYOUT --- */
  .paper-play-page {
    max-width: 900px;
    margin: 0 auto;
    padding: 3rem 1rem;
    color: var(--text-body);
  }

  /* --- HEADER & INTRO --- */
  .page-intro {
    text-align: center;
    margin-bottom: 3rem;
  }

  .page-intro h1 {
    color: var(--heading-color);
    margin-bottom: 1rem;
  }

  .intro-text {
    font-size: 1.1rem;
    color: var(--text-muted);
    max-width: 65ch;
    margin: 0 auto 2rem auto;
    line-height: 1.6;
  }

  .disclaimer-box {
    background-color: var(--surface);
    border-left: 4px solid var(--text-muted);
    padding: 1rem;
    border-radius: 0 4px 4px 0;
    text-align: left;
    max-width: 700px;
    margin: 0 auto;
    font-size: 0.9rem;
    font-style: italic;
    color: var(--text-body);
  }

  /* --- ORGANIZER GRID --- */
  .organizers-grid {
    display: flex;
    flex-direction: column;
    gap: 3rem;
    margin-top: 3rem;
    margin-bottom: 4rem; 
  }

  /* --- ORGANIZER CARD --- */
  .organizer-card {
    background-color: var(--bg);
    border: 1px solid var(--border-subtle);
    border-radius: 8px;
    padding: 2rem;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }

  .org-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid var(--border-subtle);
    padding-bottom: 1rem;
  }

  .org-identity h2 {
    margin: 0;
    font-size: 1.5rem;
    color: var(--heading-color);
    line-height: 1.2;
  }

  .region-text {
    display: block;
    color: var(--text-muted);
    font-size: 0.95rem;
    margin-top: 0.25rem;
    font-weight: 500;
  }

  /* --- DISCORD STYLES --- */
  .discord-meta-line {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.5rem; 
  }

  .discord-label {
    font-size: 0.7rem; 
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--text-muted);
    opacity: 0.8;
  }

  .discord-tag {
    color: var(--accent);
    font-weight: 200; 
    font-size: 0.8rem;
  }

  .role-badge {
    background-color: var(--surface);
    color: var(--heading-color);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    padding: 0.25rem 0.75rem;
    border-radius: 50px;
    font-weight: bold;
    border: 1px solid var(--border-subtle);
    flex-shrink: 0; 
  }

  .org-bio {
    margin-bottom: 2rem;
    line-height: 1.6;
    max-width: 75ch;
  }

  /* --- VENUES SECTION --- */
  .org-venues h3 {
    font-size: 1rem;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 1rem;
    letter-spacing: 0.05em;
  }

  .venues-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1rem;
  }

  .venue-item {
    background-color: var(--surface);
    border-radius: 6px;
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border: 1px solid transparent;
    transition: all 0.2s ease;
  }

  .venue-item:hover {
    border-color: var(--accent);
    transform: translateX(4px);
  }

  .venue-info {
    display: flex;
    flex-direction: column;
  }

  .venue-name {
    font-weight: bold;
    color: var(--heading-color);
    text-decoration: none;
    font-size: 1rem;
  }

  .venue-name:hover {
    color: var(--accent);
    text-decoration: underline;
  }

  .venue-meta {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
  }

  .venue-icon {
    color: var(--border-subtle);
  }

  .venue-item:hover .venue-icon {
    color: var(--accent);
  }

  /* --- CTA SECTION --- */
  .cta-section {
    text-align: center;
    background-color: var(--surface);
    padding: 2rem 1.5rem;
    max-width: 700px;
    margin: 0 auto 4rem auto;
    border-radius: 8px;
    border: 1px solid var(--border-subtle);
  }

  .cta-section h3 {
    margin-top: 0;
    color: var(--heading-color);
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
  }
  
  .cta-section p {
    font-size: 0.95rem;
    max-width: 500px;
    margin: 0 auto;
    color: var(--text-muted);
  }

  .btn-primary {
    display: inline-block;
    margin-top: 1.2rem;
    background-color: var(--accent);
    color: white;
    padding: 0.6rem 1.2rem;
    border-radius: 4px;
    text-decoration: none;
    font-weight: bold;
    font-size: 0.9rem;
    transition: background-color 0.2s;
  }

  .btn-primary:hover {
    background-color: var(--heading-color);
  }

  /* --- OTHER PAPER PLAY SECTION --- */
  .paper-play-container {
    margin-bottom: 5rem;
  }

  .section-header {
    margin-bottom: 2rem;
    border-bottom: 1px solid var(--border-subtle);
    padding-bottom: 1rem;
  }

  .section-header h2 {
    color: var(--heading-color);
    font-size: 1.8rem;
    margin-bottom: 0.5rem;
  }

  .disclaimer {
    background-color: var(--surface);
    border-left: 4px solid var(--text-muted);
    padding: 1rem;
    border-radius: 0 4px 4px 0;
    font-size: 0.85rem;
    color: var(--text-body);
    font-style: italic;
    line-height: 1.5;
    margin-top: 1rem;
    margin-bottom: 1rem;
    display: inline-block;
  }

  /* --- COMMUNITY STORES GRID (UPDATED) --- */
  .community-stores-grid {
    display: grid;
    /* CHANGED: Smaller minmax (200px) allows for 3-4 columns on desktop */
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem; /* Tighter gap */
    margin-bottom: 4rem;
  }

  .community-store-card {
    background-color: var(--bg);
    border: 1px solid var(--border-subtle);
    border-radius: 6px;
    /* CHANGED: Reduced padding for a more compact look */
    padding: 1rem;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
    transition: transform 0.2s ease, border-color 0.2s ease;
  }

  .community-store-card:hover {
    transform: translateY(-2px);
    border-color: var(--accent);
  }

  .store-info {
    display: flex;
    flex-direction: column;
    margin-bottom: 0.75rem; /* Reduced bottom margin */
  }

  .store-name {
    font-weight: bold;
    color: var(--heading-color);
    text-decoration: none;
    font-size: 0.95rem; /* Slightly smaller title */
    margin-bottom: 0.15rem;
  }

  .store-name:hover {
    color: var(--accent);
    text-decoration: underline;
  }

  .store-location {
    font-size: 0.8rem; /* Slightly smaller location text */
    color: var(--text-muted);
  }

  .store-frequency {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-weight: bold;
    color: var(--accent);
    background-color: var(--surface);
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    align-self: flex-start; 
  }

  .empty-state-message {
    background-color: var(--surface);
    border: 2px dashed var(--border-subtle);
    border-radius: 8px;
    padding: 3rem 1rem;
    text-align: center;
    max-width: 600px;
    margin: 2rem auto 0 auto; 
  }

  .empty-state-message h3 {
    margin-top: 0;
    color: var(--heading-color);
  }

  .button-outline {
    display: inline-block;
    margin-top: 1rem;
    padding: 0.75rem 1.5rem;
    border: 2px solid var(--accent);
    color: var(--accent);
    text-decoration: none;
    font-weight: bold;
    border-radius: 4px;
    transition: all 0.2s ease;
  }

  .button-outline:hover {
    background-color: var(--accent);
    color: white;
  }

  /* --- MOBILE --- */
  @media (max-width: 600px) {
    .org-header {
      flex-direction: column;
      gap: 1rem;
    }
    
    .role-badge {
      align-self: flex-start;
    }
  }
</style>